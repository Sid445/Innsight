<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Search Results | Innsight</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="user.css">
  <style>  
  .search-results {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      padding: 2rem;
  }
  
  .text-danger {
      color: #dc2626;
  }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-brand">
      <a href="index.html">Innsight</a>
    </div>
    <button class="nav-toggle">
      <i class="fas fa-bars"></i>
    </button>
    <div class="nav-menu">
      <a href="user_dashboard.html">Dashboard</a>
      <a href="profile.html">Profile</a>
      <a href="favorites.html">Favorites</a>
      <a href="index.html" class="logout-btn">Logout</a>
    </div>
  </nav>

  <main class="container">
    <div class="content-container fade-in">
      <div class="search-header">
        <h1>Search Results</h1>
        <div class="filter-section">
          <div class="filter-group">
            <label for="propertyType">Property Type</label>
            <select id="propertyType">
              <option value="all">All Types</option>
              <option value="hostel">Hostels</option>
              <option value="room">Rooms</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="priceRange">Price Range</label>
            <select id="priceRange">
              <option value="all">All Prices</option>
              <option value="0-5000">₹0 - ₹5,000</option>
              <option value="5000-10000">₹5,000 - ₹10,000</option>
              <option value="10000-15000">₹10,000 - ₹15,000</option>
              <option value="15000+">₹15,000+</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="amenities">Amenities</label>
            <div class="checkbox-group">
              <label><input type="checkbox" value="wifi"> WiFi</label>
              <label><input type="checkbox" value="ac"> AC</label>
              <label><input type="checkbox" value="food"> Food</label>
              <label><input type="checkbox" value="laundry"> Laundry</label>
            </div>
          </div>
          <div class="filter-group">
            <label for="sortBy">Sort By</label>
            <select id="sortBy">
              <option value="recommended">Recommended</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
              <option value="rating">Rating</option>
            </select>
          </div>
          <button class="btn-primary" onclick="applyFilters()">Apply Filters</button>
        </div>
      </div>

      <div class="search-results">
        <!-- Hostels -->
        <div class="property-card">
          <img src="https://images.unsplash.com/photo-1555854877-bab0e564b8d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Sri Sai Boys Hostel">
          <div class="property-info">
            <h3>Sri Sai Boys Hostel</h3>
            <p class="location"><i class="fas fa-map-marker-alt"></i> Ameerpet, Hyderabad</p>
            <p class="price">₹7,500/month</p>
            <div class="rating-info">
              <span class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </span>
              <span class="rating-text">4.3 (29 reviews)</span>
            </div>
            <div class="property-features">
              <span><i class="fas fa-wifi"></i> WiFi</span>
              <span><i class="fas fa-utensils"></i> Food</span>
              <span><i class="fas fa-bed"></i> Single/Shared</span>
            </div>
            <div class="card-actions">
              <a href="property-details.html" class="btn-primary">View Details</a>
              <button class="btn-secondary favorite-btn">
                <i class="far fa-heart"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="property-card">
          <img src="https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Green Girls Hostel">
          <div class="property-info">
            <h3>Syracuse House</h3>
            <p class="location"><i class="fas fa-map-marker-alt"></i> Gandimaisamma, Hyderabad</p>
            <p class="price">₹8,000/month</p>
            <div class="rating-info">
              <span class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </span>
              <span class="rating-text">4.5 (35 reviews)</span>
            </div>
            <div class="property-features">
              <span><i class="fas fa-wifi"></i> WiFi</span>
              <span><i class="fas fa-utensils"></i> Food</span>
              <span><i class="fas fa-bed"></i> Single/Shared</span>
            </div>
            <div class="card-actions">
              <a href="greengirls.html" class="btn-primary">View Details</a>
              <button class="btn-secondary favorite-btn">
                <i class="far fa-heart"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Rooms -->
        <div class="property-card">
          <img src="https://images.unsplash.com/photo-1513694203232-719a280e022f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Luxury Single Room">
          <div class="property-info">
            <h3>Olive-2 Coliving PG</h3>
            <p class="location"><i class="fas fa-map-marker-alt"></i> Madhapur, Hyderabad</p>
            <p class="price">₹10,000/month</p>
            <div class="rating-info">
              <span class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </span>
              <span class="rating-text">4.7 (50 reviews)</span>
            </div>
            <div class="property-features">
              <span><i class="fas fa-wifi"></i> WiFi</span>
              <span><i class="fas fa-couch"></i> Furnished</span>
              <span><i class="fas fa-bed"></i> Single/Shared</span>
            </div>
            <div class="card-actions">
              <a href="coliving.html" class="btn-primary">View Details</a>
              <button class="btn-secondary favorite-btn">
                <i class="far fa-heart"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="property-card">
          <img src="https://images.unsplash.com/photo-1630699144867-37acec97df5a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Shared Room">
          <div class="property-info">
            <h3>KyGo Hostels</h3>
            <p class="location"><i class="fas fa-map-marker-alt"></i> jubilee hills, Hyderabad</p>
            <p class="price">₹9,000/month</p>
            <div class="rating-info">
              <span class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </span>
              <span class="rating-text">4.5 (186 reviews)</span>
            </div>
            <div class="property-features">
              <span><i class="fas fa-wifi"></i> WiFi</span>
              <span><i class="fas fa-fan"></i> Fan</span>
              <span><i class="fas fa-bed"></i> Single/Shared</span>
            </div>
            <div class="card-actions">
              <a href="kygo.html" class="btn-primary">View Details</a>
              <button class="btn-secondary favorite-btn">
                <i class="far fa-heart"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
        <!-- Add this in your main content area -->
    <div class="search-results">
        <!-- Property cards will be dynamically added here -->
    </div>
  </main>

  <footer class="footer">
    <p>&copy; 2024 Innsight. All rights reserved.</p>
  </footer>
  <script>
        // Add this at the top of your script
    console.log('localStorage content:', localStorage.getItem('searchResults'));
    function applyFilters() {
      const propertyType = document.getElementById('propertyType').value;
      const priceRange = document.getElementById('priceRange').value;
      const amenities = Array.from(document.querySelectorAll('.checkbox-group input:checked')).map(cb => cb.value);
      const sortBy = document.getElementById('sortBy').value;
  
      const cards = document.querySelectorAll('.property-card');
  
      cards.forEach(card => {
        const type = card.querySelector('.property-info h3').innerText.toLowerCase();
        const price = parseInt(card.querySelector('.price').innerText.replace(/[^\d]/g, ''), 10);
        const cardAmenities = Array.from(card.querySelectorAll('.property-features span i')).map(i => i.classList[1].replace('fa-', ''));
  
        let isVisible = true;
  
        // Filter by property type
        if (propertyType !== 'all' && !type.includes(propertyType)) {
          isVisible = false;
        }
  
        // Filter by price range
        if (priceRange !== 'all') {
          const [min, max] = priceRange.replace('+', '').split('-').map(Number);
          if (price < min || (max && price > max)) {
            isVisible = false;
          }
        }
  
        // Filter by amenities
        if (amenities.length && !amenities.every(amenity => cardAmenities.includes(amenity))) {
          isVisible = false;
        }
  
        // Toggle visibility
        card.style.display = isVisible ? '' : 'none';
      });
  
      // Sort visible cards
      const visibleCards = Array.from(cards).filter(card => card.style.display !== 'none');
      const container = document.querySelector('.search-results');
  
      visibleCards.sort((a, b) => {
        const priceA = parseInt(a.querySelector('.price').innerText.replace(/[^\d]/g, ''), 10);
        const priceB = parseInt(b.querySelector('.price').innerText.replace(/[^\d]/g, ''), 10);
        const ratingA = parseFloat(a.querySelector('.rating-text').innerText.split(' ')[0]);
        const ratingB = parseFloat(b.querySelector('.rating-text').innerText.split(' ')[0]);
  
        if (sortBy === 'price-low') return priceA - priceB;
        if (sortBy === 'price-high') return priceB - priceA;
        if (sortBy === 'rating') return ratingB - ratingA;
        return 0; // Default: no sorting
      });
  
      visibleCards.forEach(card => container.appendChild(card));
    }
// Remove all the duplicate favorite button handlers and replace with this single unified version
document.addEventListener('DOMContentLoaded', function() {
  // Set initial favorite states
  setInitialFavoriteStates();

  // Single favorite button click handler for all buttons
  document.querySelectorAll('.favorite-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const card = this.closest('.property-card');
      const icon = this.querySelector('i');
      const isFavorite = icon.classList.contains('fas');
      
      // Get property data
      const property = {
        id: Date.now().toString(),
        name: card.querySelector('h3').textContent,
        location: card.querySelector('.location').textContent,
        price: card.querySelector('.price').textContent,
        image: card.querySelector('img').src,
        stars: card.querySelector('.stars').innerHTML,
        rating: card.querySelector('.rating-text').textContent,
        features: Array.from(card.querySelectorAll('.property-features span')).map(span => ({
          icon: span.querySelector('i').className,
          text: span.textContent.trim()
        })),
        detailsLink: card.querySelector('.btn-primary').href
      };

      // Update localStorage
      let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
      
      if (!isFavorite) {
        // Add to favorites if not already present
        if (!favorites.some(p => p.name === property.name)) {
          favorites.push(property);
          icon.classList.remove('far');
          icon.classList.add('fas', 'text-danger');
        }
      } else {
        // Remove from favorites
        favorites = favorites.filter(p => p.name !== property.name);
        icon.classList.remove('fas', 'text-danger');
        icon.classList.add('far');
      }

      localStorage.setItem('favorites', JSON.stringify(favorites));
      
      // Debug log
      console.log('Updated favorites:', JSON.parse(localStorage.getItem('favorites')));
    });
  });
});

// Helper function to set initial states
function setInitialFavoriteStates() {
  const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
  const propertyCards = document.querySelectorAll('.property-card');
  
  propertyCards.forEach(card => {
    const propertyName = card.querySelector('h3').textContent;
    const favoriteBtn = card.querySelector('.favorite-btn i');
    
    // Check if this property is in favorites
    const isFavorite = favorites.some(fav => fav.name === propertyName);
    
    if (isFavorite) {
      favoriteBtn.classList.remove('far');
      favoriteBtn.classList.add('fas', 'text-danger');
    } else {
      favoriteBtn.classList.remove('fas', 'text-danger');
      favoriteBtn.classList.add('far');
    }
  });
}
   
    document.addEventListener('DOMContentLoaded', function() {
      // Load properties from localStorage
      const searchResults = JSON.parse(localStorage.getItem('searchResults') || '[]');
      const searchResultsGrid = document.querySelector('.search-results');
  
      // Helper function for amenity icons
      function getAmenityIcon(amenity) {
          const icons = {
              wifi: 'wifi',
              ac: 'snowflake',
              food: 'utensils',
              laundry: 'tshirt',
              parking: 'parking'
          };
          return icons[amenity] || 'check';
      }
  
      function capitalizeFirstLetter(string) {
          return string.charAt(0).toUpperCase() + string.slice(1);
      }
  
      // Display each property from localStorage
      searchResults.forEach(data => {
          const card = document.createElement('div');
          card.className = 'property-card';
          card.innerHTML = `
              <img src="${data.images ? 'default-property.jpg' : 'default-property.jpg'}" 
                   alt="${data.name}">
              <div class="property-info">
                  <h3>${data.name}</h3>
                  <p class="location"><i class="fas fa-map-marker-alt"></i> ${data.location}</p>
                  <p class="price">₹${data.price}/month</p>
                  <div class="rating-info">
                      <span class="stars">
                          <i class="fas fa-star"></i>
                          <i class="fas fa-star"></i>
                          <i class="fas fa-star"></i>
                          <i class="fas fa-star"></i>
                          <i class="fas fa-star-half-alt"></i>
                      </span>
                      <span class="rating-text">New Listing</span>
                  </div>
                  <div class="property-features">
                      ${data.amenities.map(amenity => `
                          <span><i class="fas fa-${getAmenityIcon(amenity)}"></i> ${capitalizeFirstLetter(amenity)}</span>
                      `).join('')}
                      <span><i class="fas fa-bed"></i> Single/Shared</span>
                  </div>
                  <div class="card-actions">
                      <a href="property-details.html" class="btn-primary">View Details</a>
                      <button class="btn-secondary favorite-btn">
                          <i class="far fa-heart"></i>
                      </button>
                  </div>
              </div>
          `;
  
          // Add favorite button functionality
          const favoriteBtn = card.querySelector('.favorite-btn');
          favoriteBtn.addEventListener('click', function() {
              const icon = this.querySelector('i');
              icon.classList.toggle('far');
              icon.classList.toggle('fas');
              icon.classList.toggle('text-danger');
          });
  
          searchResultsGrid.appendChild(card);
      });
  
      // Add this function to check and set initial favorite states
      function setInitialFavoriteStates() {
          const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
          const propertyCards = document.querySelectorAll('.property-card');
          
          propertyCards.forEach(card => {
              const propertyName = card.querySelector('h3').textContent;
              const favoriteBtn = card.querySelector('.favorite-btn i');
              
              // Check if this property is in favorites
              const isFavorite = favorites.some(fav => fav.name === propertyName);
              
              if (isFavorite) {
                  favoriteBtn.classList.remove('far');
                  favoriteBtn.classList.add('fas', 'text-danger');
              } else {
                  favoriteBtn.classList.remove('fas', 'text-danger');
                  favoriteBtn.classList.add('far');
              }
          });
      }
  
      // Call this when page loads
      setInitialFavoriteStates();
      
      // Debug log
      console.log('Current properties:', searchResults);
  });
  </script>
</body>
</html>
